'use strict';function G(W,E){var t=T();return G=function(H,s){H=H-0x74;var F=t[H];return F;},G(W,E);}var x=G;(function(W,E){var N=G,t=W();while(!![]){try{var H=-parseInt(N(0xac))/0x1*(-parseInt(N(0xaa))/0x2)+parseInt(N(0x95))/0x3+-parseInt(N(0xe1))/0x4*(parseInt(N(0xaf))/0x5)+parseInt(N(0x8a))/0x6+parseInt(N(0xd5))/0x7*(parseInt(N(0xe3))/0x8)+-parseInt(N(0x77))/0x9+parseInt(N(0xbc))/0xa;if(H===E)break;else t['push'](t['shift']());}catch(s){t['push'](t['shift']());}}}(T,0x45278));function T(){var T0=['2264msgJfg','NCwMZ','__importDefault','moveToNext','IZlLK','JGQkl','raw','chat_id','2|1|5|3|4|0','8|5|6|3|4|1|0|7|2|9','getPrevChat','FIELD_TYPE_INTEGER','filter','5004621yXWmOu','../../../utils/mapper/column_const','text','ALL_COLUMN','XCXPi','supplyAsync','ZTBMw','paxwg','getFloat','\x20WHERE\x20c_id\x20>\x20?\x20AND\x20c_chat_id\x20=\x20?\x20ORDER\x20BY\x20c_id\x20\x20LIMIT\x201\x20OFFSET\x20?','2|4|0|1|3','HXHmG','xnJVB','getString','moveToFirst','hBLLv','userMapper','lYNSA','push','555798CYxWZK','\x20WHERE\x20c__id\x20>\x20?\x20AND\x20c__id\x20<=\x20?\x20ORDER\x20BY\x20c__id','lCrBq','SELECT\x20active_member_ids\x20FROM\x20chat_rooms\x20WHERE\x20id\x20=\x20?','pUqaS','getLastID','ChatManager','values','channel','zCVbz','length','1264833IVuKHS','nJCUo','default','bKZXj','qbwdJ','jFWTO','where','zKfiU','from','Mapper','split','FIELD_TYPE_NULL','fvTwO','NEdli','parseOnlyNum','BHlsQ','\x20WHERE\x20c_id\x20<\x20?\x20AND\x20c_chat_id\x20=\x20?\x20ORDER\x20BY\x20c_id\x20\x20DESC\x20LIMIT\x201\x20OFFSET\x20?','OCEtf','_getMinIdsToUsers','SELECT\x20active_member_ids,watermarks\x20from\x20chat_rooms\x20WHERE\x20id\x20=\x20?','reduce','2gLFPNg','yInJC','14887MuVGcf','DB2.friends','ushwX','40WOURXJ','getUnreadMember','HlNVL','zBlCA','getMultipleUsersByIDs','rawQuery','teTUc','defineProperty','\x20\x20WHERE\x20c_id\x20=\x20?','close','setUserKey','ivKWZ','join','3424710wPREhJ','getReadMember','CompletableFuture','ktyER','database','getChatUserByLogID','_instance','__esModule','XTQgG','SELECT\x20','../../../BigJSON','prototype','getOneUserByID','getDisplayName','PbDHH','BqbGX','CHAT_USER_JOIN_COLUMN','MAX_SAFE_INTEGER','UtHYj','select','SELECT\x20_id\x20\x20FROM\x20chat_logs\x20ORDER\x20BY\x20_id\x20DESC\x20LIMIT\x201','USER_COLUMN','\x20FROM\x20DB2.friends\x20WHERE\x20id\x20=\x20?','getLong','getMembersByRoomID','1295eTHQGx','getColumnCount','ehCvY','cursorToUser','BigJSON','FIELD_TYPE_FLOAT','gTrcc','cursorToChatUser','prepare','Cursor','HQsiM','userKey','42316lqCnfz','BhiUJ'];T=function(){return T0;};return T();}var __importDefault=this&&this[x(0xe5)]||function(W){var r=x;return W&&W[r(0xc3)]?W:{'default':W};};Object[x(0xb6)](exports,x(0xc3),{'value':!0x0}),exports[x(0x90)]=void 0x0;var BigJSON_1=require(x(0xc6)),sql_bricks_1=__importDefault(require('../../../sql-bricks')),decrypt_1=__importDefault(require('../decrypt')),utils_1=require('../../../utils'),column_const_1=require(x(0x78)),parseOnlyNum=BigJSON_1[x(0xd9)][x(0xa3)],CompletableFuture=java['util']['concurrent'][x(0xbe)],Executors=java['util']['concurrent']['Executors'],groupBy=function(W,E){var R=x;return W[R(0xa9)](function(H,s){return H[s[E]]=s,H;},{});},ChatManager=exports['ChatManager']=(function(){var j=x,W={'ZTBMw':function(t,H){return t===H;},'nJCUo':function(t,H){return t===H;},'xnJVB':function(t,H){return t===H;},'ktyER':'아직\x20없음','teTUc':function(t,H){return t===H;},'gTrcc':function(t,H){return t+H;},'ushwX':j(0xc5),'zKfiU':j(0xb7),'XCXPi':function(t,H){return t<H;},'ehCvY':j(0xa8),'HQsiM':function(t,H){return t(H);},'pUqaS':function(t,H){return t(H);},'fBmIg':function(t,H){return t>=H;},'BhiUJ':function(t,H){return t(H);},'zBPxr':j(0xeb),'NEdli':function(t,H){return t<H;},'HXHmG':function(t,H){return t===H;},'BqbGX':function(t,H){return t+H;},'jFWTO':j(0xa5),'yInJC':function(t,H){return t-H;},'fvTwO':'2|0|5|4|3|1','zCVbz':function(t,H){return t<H;},'IZlLK':function(t,H){return t+H;},'UtHYj':function(t,H){return t+H;},'qbwdJ':function(t,H){return t+H;},'OCEtf':function(t,H){return t(H);},'lYNSA':j(0x81),'eBOYc':function(t,H){return t||H;},'HlNVL':function(t,H){return t(H);},'CsfDd':function(t,H){return t+H;},'BHlsQ':j(0x8b),'bKZXj':j(0xec),'hBLLv':function(t,H){return t<H;},'Gqixz':function(t,H){return t<=H;},'zBlCA':j(0xad),'JGQkl':'name','dJAgt':'1|2|0|4|3','paxwg':function(t,H){return t===H;},'ivKWZ':j(0x8d),'PbDHH':function(t,H){return t(H);},'NCwMZ':function(t,H){return t(H);},'XTQgG':function(t,H){return t>H;}};function E(t,H){var n=j;W[n(0x7d)](void 0x0,H)&&(H=''),this['db']=t,this['userKey']=H,utils_1[n(0x9e)][n(0xb9)](this[n(0xe0)]);}return E['getInstance']=function(H,s){var J=j;if(void 0x0===H&&(H=null),W[J(0x96)](void 0x0,s)&&(s=''),W['ZTBMw']('',s)||W[J(0x83)](null,H)){if(W[J(0x7d)](null,E[J(0xc2)]))throw new Error(W[J(0xbf)]);return E[J(0xc2)];}return W[J(0xb5)](null,E[J(0xc2)])&&(E[J(0xc2)]=new E(H,s)),E[J(0xc2)];},E[j(0xc7)][j(0xc1)]=function(H){var D=j,s=W['gTrcc'](W[D(0xdb)](W[D(0xdb)](W[D(0xae)],column_const_1['CHAT_USER_COLUMN']),column_const_1[D(0xcc)]),W[D(0x9c)]),F=this['db'][D(0xb4)](s,[H]);if(!F[D(0x85)]())return F[D(0xb8)](),null;var b=utils_1[D(0x9e)][D(0xdc)](F,this[D(0xe0)]);return F[D(0xb8)](),b;},E[j(0xc7)][j(0xb0)]=function(H,F){var q=j,b=this['db'][q(0xb4)](W[q(0xd7)],[H]);if(!b[q(0x85)]())return b[q(0xb8)](),[];var m=W[q(0xdf)](parseOnlyNum,W[q(0xdf)](String,b['getString'](0x0))),Z=W['pUqaS'](parseOnlyNum,W[q(0x8e)](String,b[q(0x84)](0x1)));return m=m[q(0x76)](function(u,X){var O=q;if(W[O(0x7b)](Z[X],F))return u;}),this[q(0xb3)](m);},E['prototype'][j(0xbd)]=function(H,F){var Q=j,b={'lCrBq':function(X,C){return W['fBmIg'](X,C);}},m=this['db'][Q(0xb4)]('SELECT\x20active_member_ids,watermarks\x20from\x20chat_rooms\x20WHERE\x20id\x20=\x20?',[H]);if(!m['moveToFirst']())return m[Q(0xb8)](),[];var Z=W[Q(0x8e)](parseOnlyNum,W[Q(0xe2)](String,m['getString'](0x0))),u=W[Q(0x8e)](parseOnlyNum,W[Q(0x8e)](String,m['getString'](0x1)));return Z=Z['filter'](function(X,C){var o=Q;if(b[o(0x8c)](u[C],F))return X;}),this['getMultipleUsersByIDs'](Z);},E['prototype'][j(0x74)]=function(H,F){var f=j,b=W['zBPxr']['split']('|'),m=0x0;while(!![]){switch(b[m++]){case'0':return Z[f(0x92)]=H[f(0x92)],X['close'](),Z;case'1':if(W[f(0xa2)](F,0x0))return this['getNextChat'](H,-F);continue;case'2':if(void 0x0===F&&(F=0x1),W[f(0x82)](0x0,F))return H;continue;case'3':if(!X['moveToFirst']())return X['close'](),null;continue;case'4':var Z=utils_1[f(0x9e)][f(0xdc)](X,this[f(0xe0)]);continue;case'5':var u=W[f(0xdb)](W[f(0xcb)](W[f(0xae)],column_const_1['CHAT_USER_COLUMN']),column_const_1[f(0xcc)])+W[f(0x9a)],X=this['db'][f(0xb4)](u,[H[f(0xe9)]['id'],H[f(0xe9)]['chat_id'],String(W['yInJC'](F,0x1))]);continue;}break;}},E[j(0xc7)]['getNextChat']=function(H,F){var d=j,b=W[d(0xa1)][d(0x9f)]('|'),m=0x0;while(!![]){switch(b[m++]){case'0':if(W[d(0x93)](F,0x0))return this[d(0x74)](H,-F);continue;case'1':return Z[d(0x92)]=H[d(0x92)],X[d(0xb8)](),Z;case'2':if(W[d(0x82)](void 0x0,F)&&(F=0x1),0x0===F)return H;continue;case'3':var Z=utils_1[d(0x9e)][d(0xdc)](X,this[d(0xe0)]);continue;case'4':if(!X['moveToFirst']())return X[d(0xb8)](),null;continue;case'5':var u=W[d(0xe7)](W[d(0xce)](W['qbwdJ'](d(0xc5),column_const_1['CHAT_USER_COLUMN']),column_const_1[d(0xcc)]),d(0x80)),X=this['db']['rawQuery'](u,[H[d(0xe9)]['id'],H[d(0xe9)][d(0xea)],W[d(0xa6)](String,W[d(0xab)](F,0x1))]);continue;}break;}},E[j(0xc7)]['getChatStack']=function(H,F){var M=j,b=W[M(0x88)][M(0x9f)]('|'),m=0x0;while(!![]){switch(b[m++]){case'0':if(!X[M(0x85)]())return X[M(0xb8)](),[];continue;case'1':do{var Z=utils_1[M(0x9e)]['cursorToAll'](X,this['userKey']);C[M(0x89)](Z);}while(X['moveToNext']());continue;case'2':void 0x0===H&&(H=void 0x0),void 0x0===F&&(F=void 0x0),H=W['eBOYc'](H,'0'),F=F||W[M(0xb1)](String,Number[M(0xcd)]);continue;case'3':return X['close'](),C;case'4':var u=W['CsfDd'](W[M(0x99)](W[M(0xdb)](W[M(0xae)],column_const_1[M(0x7a)]),column_const_1['ALL_JOIN_COLUMN']),W[M(0xa4)]),X=this['db'][M(0xb4)](u,[H,F]),C=[];continue;}break;}},E[j(0xc7)][j(0x8f)]=function(){var z=j,t=this['db'][z(0xb4)](z(0xd0),[]);if(t['moveToFirst']()){var H=W['HlNVL'](String,t[z(0x84)](0x0));return t[z(0xb8)](),H;}t['close']();},E[j(0xc7)][j(0xc8)]=function(H){var Y=j,s=W['ushwX']+column_const_1[Y(0xd1)]+Y(0xd2),F=this['db']['rawQuery'](s,[H]);if(!F['moveToLast']())return F[Y(0xb8)](),null;var b=utils_1['Mapper']['cursorToUser'](F,this[Y(0xe0)]);return F[Y(0xb8)](),b;},E['prototype']['getMultipleUsersByIDs']=function(H,F){var L=j,b=W[L(0x98)]['split']('|'),m=0x0;while(!![]){switch(b[m++]){case'0':I['close']();continue;case'1':do{C[L(0x89)](utils_1[L(0x9e)]['cursorToUserObject'](I));}while(I[L(0xe6)]());continue;case'2':for(var Z=0x0;W[L(0x86)](Z,k['length']);Z++){var X=k[Z]['get']();w[L(0x89)](X);}continue;case'3':if(!I['moveToFirst']())return I['close'](),F?{}:[];continue;case'4':var C=[];continue;case'5':if(W[L(0x7d)](void 0x0,F)&&(F=!0x1),W['Gqixz'](H[L(0x94)],0xf))return this[L(0xa7)](H,F);continue;case'6':var w=[],V=sql_bricks_1[L(0x97)]['select'](column_const_1['USER_COLUMN'])[L(0x9d)](W[L(0xb2)])[L(0x9b)]({'id[^]':H})[L(0xdd)](),I=this['db'][L(0xb4)](V[L(0x79)],V[L(0x91)]);continue;case'7':for(var k=[],B=Executors['newFixedThreadPool'](0x4),S=function(K){var h=L,P=CompletableFuture[h(0x7c)](function(){var i=h;return utils_1[i(0x9e)][i(0x87)](K,A[i(0xe0)]);},B);k['push'](P);},y=0x0,g=C;W['zCVbz'](y,g['length']);y++){S(Z=g[y]);}continue;case'8':var A=this;continue;case'9':return B['shutdown'](),F?groupBy(w,'id'):w;}break;}},E[j(0xc7)][j(0xc9)]=function(H){var v=j,s=sql_bricks_1[v(0x97)]['select'](W[v(0xe8)])['from'](W['zBlCA'])[v(0x9b)]({'id[^]':H})[v(0xdd)](),F=this['db']['rawQuery'](s['text'],s['values']),b=[];if(!F[v(0x85)]())return F['close'](),'';do{b[v(0x89)]((0x0,decrypt_1[v(0x97)])(this[v(0xe0)],0x1e,F[v(0x84)](0x0)));}while(F['moveToNext']());return F[v(0xb8)](),b[v(0xbb)](',\x20');},E['prototype']['_getMinIdsToUsers']=function(H,F){var U=j,b=W['dJAgt']['split']('|'),m=0x0;while(!![]){switch(b[m++]){case'0':if(!X[U(0x85)]())return X[U(0xb8)](),F?{}:[];continue;case'1':W[U(0x7e)](void 0x0,F)&&(F=!0x1);continue;case'2':var Z=[],u=sql_bricks_1['default'][U(0xcf)](column_const_1['USER_COLUMN'])[U(0x9d)](W[U(0xb2)])[U(0x9b)]({'id[^]':H})[U(0xdd)](),X=this['db'][U(0xb4)](u[U(0x79)],u[U(0x91)]);continue;case'3':return X[U(0xb8)](),Z;case'4':do{Z['push'](utils_1[U(0x9e)][U(0xd8)](X,this[U(0xe0)]));}while(X['moveToNext']());continue;}break;}},E[j(0xc7)][j(0xd4)]=function(H){var c=j,s=this['db'][c(0xb4)](W[c(0xba)],[H]);if(!s['moveToLast']())return s[c(0xb8)](),null;var F=W[c(0xca)](parseOnlyNum,String(s['getString'](0x0)));return s[c(0xb8)](),this[c(0xb3)](F);},E[j(0xc7)][j(0xb4)]=function(H,F){var e=j,b=[];try{var m=this['db']['rawQuery'](H,null!=F?F:[]);if(!m[e(0x85)]())return m['close'](),[];var Z=+m[e(0xd6)]();do{for(var X={},C=0x0;W[e(0x93)](C,Z);C++){var w=W[e(0xdf)](String,m['getColumnName'](C));switch(m['getType'](C)){case android[e(0xc0)][e(0xde)][e(0xa0)]:X[w]=null;break;case android[e(0xc0)][e(0xde)][e(0xda)]:X[w]=W[e(0xe4)](Number,m[e(0x7f)](C));break;case android['database'][e(0xde)][e(0x75)]:var V=Number(m[e(0xd3)](C));W[e(0xc4)](V,Number[e(0xcd)])&&(V=W[e(0xe4)](String,V)),X[w]=V;break;default:X[w]=W[e(0xca)](String,m[e(0x84)](C));}}b['push'](X);}while(m['moveToNext']());return m[e(0xb8)](),b;}catch(I){return b;}},E['_instance']=null,E;}());